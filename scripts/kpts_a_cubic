#!/bin/bash

# Define the range of k-points to test. For example, from 3x3x3 to 15x15x15.
K_START=3
K_END=15
K_INCREMENT=2  # Choose odd K-mesh grids only

############################### Create KPOINTS directories #######################################

# Loop over the specified range of k-point values.
for (( K=$K_START; K<=$K_END; K+=$K_INCREMENT ))
do
   # Create a directory for the current k-point grid.
   mkdir KPOINTS_${K}x${K}x${K}
   cd KPOINTS_${K}x${K}x${K}

   # Copy VASP input files from the parent directory.
   cp ../INCAR .
   cp ../POSCAR .
   cp ../POTCAR .

   # Create the KPOINTS file for the current k-point grid.
   echo "Automatic mesh" > KPOINTS
   echo "0" >> KPOINTS
   echo "Gamma" >> KPOINTS
   echo "$K $K $K" >> KPOINTS
   echo "0 0 0" >> KPOINTS

   # Submit VASP job (using mpirun for parallel execution). Modify mpirun -np based on your system.
   mpirun -np 36 vasp_std > vasp_output_${K}x${K}x${K}.log

   # Go back to the parent directory.
   cd ..
done

echo "K-point grid test submission completed"
